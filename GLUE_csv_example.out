/fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Codes/1_GLUE_preprocessing.py:79: FutureWarning: X.dtype being converted to np.float32 from object. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  rna = anndata.AnnData(np.transpose(rna_array))
/fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Codes/1_GLUE_preprocessing.py:95: FutureWarning: X.dtype being converted to np.float32 from object. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  atac = anndata.AnnData(np.transpose(atac_array))
OMP: Info #277: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
/users/PAS1475/liyang/.conda/envs/GLUE_env/lib/python3.9/site-packages/sklearn/utils/extmath.py:368: FutureWarning: If 'random_state' is not supplied, the current default is to use 0 as a fixed seed. This will change to  None in version 1.2 leading to non-deterministic results that better reflect nature of the randomized_svd solver. If you want to silence this warning, set 'random_state' to an integer seed or to None explicitly depending if you want your code to be deterministic or not.
  warnings.warn(
Finished loading the GTF file to annotate gene locations: /fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Annotations/gencode.v40.annotation.gtf.gz.

Finished loading the RNA expression matrix containing 1036 cells and 18666 genes.

Finished loading the ATAC accessibility matrix containing 1036 cells and 25137 genes.

  0%|          | 0/14825 [00:00<?, ?it/s] 10%|▉         | 1479/14825 [00:00<00:00, 14784.37it/s] 26%|██▋       | 3905/14825 [00:00<00:00, 20351.76it/s] 48%|████▊     | 7175/14825 [00:00<00:00, 25986.02it/s] 71%|███████   | 10513/14825 [00:00<00:00, 28903.15it/s] 92%|█████████▏| 13622/14825 [00:00<00:00, 29688.49it/s]100%|██████████| 14825/14825 [00:00<00:00, 27945.49it/s]
  0%|          | 0/14825 [00:00<?, ?it/s] 10%|▉         | 1450/14825 [00:00<00:00, 14496.52it/s] 20%|██        | 3035/14825 [00:00<00:00, 15291.65it/s] 33%|███▎      | 4865/14825 [00:00<00:00, 16662.80it/s] 44%|████▍     | 6532/14825 [00:00<00:00, 15919.09it/s] 55%|█████▍    | 8129/14825 [00:00<00:00, 15345.11it/s] 67%|██████▋   | 9895/14825 [00:00<00:00, 16096.39it/s] 78%|███████▊  | 11512/14825 [00:00<00:00, 10506.44it/s] 89%|████████▉ | 13172/14825 [00:00<00:00, 11893.84it/s]100%|██████████| 14825/14825 [00:01<00:00, 13813.94it/s]
/users/PAS1475/liyang/.conda/envs/GLUE_env/lib/python3.9/site-packages/anndata/compat/_overloaded_dict.py:106: ImplicitModificationWarning: Trying to modify attribute `._uns` of view, initializing view as actual.
  self.data[key] = value
[INFO] autodevice: Using GPU 0 as computation device.
[INFO] SCGLUEModel: Setting `graph_batch_size` = 12404
[INFO] SCGLUEModel: Setting `max_epochs` = 1648
[INFO] SCGLUEModel: Setting `patience` = 138
[INFO] SCGLUEModel: Setting `reduce_lr_patience` = 69
[INFO] SCGLUETrainer: Using training directory: "csv_example_out"
/users/PAS1475/liyang/.conda/envs/GLUE_env/lib/python3.9/site-packages/torch/distributions/negative_binomial.py:97: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /users/PAS1475/liyang/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at  /opt/conda/conda-bld/pytorch_1646756402876/work/aten/src/ATen/native/cuda/jit_utils.cpp:860.)
  log_normalization = (-torch.lgamma(self.total_count + value) + torch.lgamma(1. + value) +
[INFO] SCGLUETrainer: [Epoch 10] train={'g_nll': 0.489, 'g_kl': 0.003, 'g_elbo': 0.492, 'x_rna_nll': 0.107, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.11, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.112, 'dsc_loss': 0.683, 'vae_loss': 0.243, 'gen_loss': 0.209}, val={'g_nll': 0.488, 'g_kl': 0.003, 'g_elbo': 0.491, 'x_rna_nll': 0.11, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.114, 'x_atac_nll': 0.113, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.115, 'dsc_loss': 0.678, 'vae_loss': 0.248, 'gen_loss': 0.215}, 0.7s elapsed
[INFO] SCGLUETrainer: [Epoch 20] train={'g_nll': 0.482, 'g_kl': 0.004, 'g_elbo': 0.486, 'x_rna_nll': 0.105, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.111, 'dsc_loss': 0.685, 'vae_loss': 0.238, 'gen_loss': 0.204}, val={'g_nll': 0.477, 'g_kl': 0.004, 'g_elbo': 0.481, 'x_rna_nll': 0.102, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.111, 'dsc_loss': 0.68, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 30] train={'g_nll': 0.47, 'g_kl': 0.005, 'g_elbo': 0.474, 'x_rna_nll': 0.101, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.107, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.688, 'vae_loss': 0.231, 'gen_loss': 0.197}, val={'g_nll': 0.471, 'g_kl': 0.005, 'g_elbo': 0.476, 'x_rna_nll': 0.109, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.106, 'x_atac_kl': 0.001, 'x_atac_elbo': 0.107, 'dsc_loss': 0.684, 'vae_loss': 0.238, 'gen_loss': 0.204}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 40] train={'g_nll': 0.455, 'g_kl': 0.006, 'g_elbo': 0.46, 'x_rna_nll': 0.098, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.101, 'x_atac_nll': 0.105, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.106, 'dsc_loss': 0.69, 'vae_loss': 0.226, 'gen_loss': 0.191}, val={'g_nll': 0.458, 'g_kl': 0.006, 'g_elbo': 0.463, 'x_rna_nll': 0.101, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.106, 'x_atac_kl': 0.001, 'x_atac_elbo': 0.107, 'dsc_loss': 0.694, 'vae_loss': 0.23, 'gen_loss': 0.195}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 50] train={'g_nll': 0.443, 'g_kl': 0.007, 'g_elbo': 0.45, 'x_rna_nll': 0.096, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.1, 'x_atac_nll': 0.101, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.103, 'dsc_loss': 0.69, 'vae_loss': 0.22, 'gen_loss': 0.186}, val={'g_nll': 0.441, 'g_kl': 0.007, 'g_elbo': 0.447, 'x_rna_nll': 0.1, 'x_rna_kl': 0.003, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.106, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.107, 'dsc_loss': 0.697, 'vae_loss': 0.229, 'gen_loss': 0.194}, 0.7s elapsed
[INFO] SCGLUETrainer: [Epoch 60] train={'g_nll': 0.433, 'g_kl': 0.008, 'g_elbo': 0.44, 'x_rna_nll': 0.094, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.098, 'x_atac_nll': 0.101, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.103, 'dsc_loss': 0.693, 'vae_loss': 0.219, 'gen_loss': 0.184}, val={'g_nll': 0.434, 'g_kl': 0.008, 'g_elbo': 0.441, 'x_rna_nll': 0.102, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.105, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.107, 'dsc_loss': 0.691, 'vae_loss': 0.231, 'gen_loss': 0.196}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 70] train={'g_nll': 0.427, 'g_kl': 0.008, 'g_elbo': 0.436, 'x_rna_nll': 0.093, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.098, 'x_atac_nll': 0.099, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.101, 'dsc_loss': 0.691, 'vae_loss': 0.216, 'gen_loss': 0.182}, val={'g_nll': 0.429, 'g_kl': 0.008, 'g_elbo': 0.437, 'x_rna_nll': 0.102, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.102, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.104, 'dsc_loss': 0.692, 'vae_loss': 0.228, 'gen_loss': 0.193}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 80] train={'g_nll': 0.425, 'g_kl': 0.009, 'g_elbo': 0.434, 'x_rna_nll': 0.091, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.096, 'x_atac_nll': 0.098, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.1, 'dsc_loss': 0.693, 'vae_loss': 0.213, 'gen_loss': 0.179}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.099, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.103, 'x_atac_nll': 0.104, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.106, 'dsc_loss': 0.696, 'vae_loss': 0.226, 'gen_loss': 0.191}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 90] train={'g_nll': 0.423, 'g_kl': 0.009, 'g_elbo': 0.431, 'x_rna_nll': 0.089, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.094, 'x_atac_nll': 0.096, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.098, 'dsc_loss': 0.693, 'vae_loss': 0.21, 'gen_loss': 0.175}, val={'g_nll': 0.423, 'g_kl': 0.009, 'g_elbo': 0.432, 'x_rna_nll': 0.102, 'x_rna_kl': 0.004, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.106, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.692, 'vae_loss': 0.231, 'gen_loss': 0.196}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 100] train={'g_nll': 0.422, 'g_kl': 0.009, 'g_elbo': 0.431, 'x_rna_nll': 0.088, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.095, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.098, 'dsc_loss': 0.693, 'vae_loss': 0.208, 'gen_loss': 0.173}, val={'g_nll': 0.423, 'g_kl': 0.009, 'g_elbo': 0.432, 'x_rna_nll': 0.099, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.108, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.11, 'dsc_loss': 0.694, 'vae_loss': 0.232, 'gen_loss': 0.197}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 110] train={'g_nll': 0.421, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.088, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.094, 'x_atac_nll': 0.095, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.098, 'dsc_loss': 0.693, 'vae_loss': 0.209, 'gen_loss': 0.174}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.115, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.117, 'dsc_loss': 0.695, 'vae_loss': 0.24, 'gen_loss': 0.206}, 0.6s elapsed
Epoch 00113: reducing learning rate of group 0 to 2.0000e-04.
Epoch 00113: reducing learning rate of group 0 to 2.0000e-04.
[INFO] LRScheduler: Learning rate reduction: step 1
[INFO] SCGLUETrainer: [Epoch 120] train={'g_nll': 0.421, 'g_kl': 0.009, 'g_elbo': 0.43, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.095, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.692, 'vae_loss': 0.207, 'gen_loss': 0.173}, val={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.106, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.691, 'vae_loss': 0.233, 'gen_loss': 0.199}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 130] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.095, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.691, 'vae_loss': 0.206, 'gen_loss': 0.172}, val={'g_nll': 0.422, 'g_kl': 0.009, 'g_elbo': 0.431, 'x_rna_nll': 0.098, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.102, 'x_atac_nll': 0.113, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.115, 'dsc_loss': 0.693, 'vae_loss': 0.235, 'gen_loss': 0.2}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 140] train={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.205, 'gen_loss': 0.171}, val={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.108, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.113, 'x_atac_nll': 0.107, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.109, 'dsc_loss': 0.692, 'vae_loss': 0.239, 'gen_loss': 0.205}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 150] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.206, 'gen_loss': 0.171}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.102, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.106, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.691, 'vae_loss': 0.232, 'gen_loss': 0.197}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 160] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.205, 'gen_loss': 0.17}, val={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.107, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.113, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.115, 'dsc_loss': 0.691, 'vae_loss': 0.244, 'gen_loss': 0.21}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 170] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.693, 'vae_loss': 0.205, 'gen_loss': 0.171}, val={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.106, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.691, 'vae_loss': 0.233, 'gen_loss': 0.199}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 180] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.692, 'vae_loss': 0.207, 'gen_loss': 0.172}, val={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.104, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.104, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.106, 'dsc_loss': 0.689, 'vae_loss': 0.233, 'gen_loss': 0.198}, 0.6s elapsed
Epoch 00183: reducing learning rate of group 0 to 2.0000e-05.
Epoch 00183: reducing learning rate of group 0 to 2.0000e-05.
[INFO] LRScheduler: Learning rate reduction: step 2
[INFO] SCGLUETrainer: [Epoch 190] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.095, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.098, 'dsc_loss': 0.693, 'vae_loss': 0.207, 'gen_loss': 0.172}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.099, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.111, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.114, 'dsc_loss': 0.694, 'vae_loss': 0.235, 'gen_loss': 0.2}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 200] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.085, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.691, 'vae_loss': 0.204, 'gen_loss': 0.17}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.101, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.103, 'dsc_loss': 0.691, 'vae_loss': 0.226, 'gen_loss': 0.191}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 210] train={'g_nll': 0.421, 'g_kl': 0.009, 'g_elbo': 0.43, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.691, 'vae_loss': 0.206, 'gen_loss': 0.172}, val={'g_nll': 0.422, 'g_kl': 0.009, 'g_elbo': 0.431, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.111, 'dsc_loss': 0.691, 'vae_loss': 0.234, 'gen_loss': 0.199}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 220] train={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.691, 'vae_loss': 0.204, 'gen_loss': 0.17}, val={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.108, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.111, 'dsc_loss': 0.691, 'vae_loss': 0.236, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 230] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.694, 'vae_loss': 0.206, 'gen_loss': 0.171}, val={'g_nll': 0.421, 'g_kl': 0.009, 'g_elbo': 0.43, 'x_rna_nll': 0.099, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.111, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.113, 'dsc_loss': 0.688, 'vae_loss': 0.234, 'gen_loss': 0.2}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 240] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.205, 'gen_loss': 0.171}, val={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.104, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.112, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.114, 'dsc_loss': 0.69, 'vae_loss': 0.24, 'gen_loss': 0.206}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 250] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.691, 'vae_loss': 0.204, 'gen_loss': 0.17}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.111, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.113, 'dsc_loss': 0.687, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
Epoch 00253: reducing learning rate of group 0 to 2.0000e-06.
Epoch 00253: reducing learning rate of group 0 to 2.0000e-06.
[INFO] LRScheduler: Learning rate reduction: step 3
[INFO] SCGLUETrainer: [Epoch 260] train={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.206, 'gen_loss': 0.171}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.115, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.117, 'dsc_loss': 0.689, 'vae_loss': 0.24, 'gen_loss': 0.206}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 270] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.691, 'vae_loss': 0.206, 'gen_loss': 0.172}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.101, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.103, 'dsc_loss': 0.692, 'vae_loss': 0.226, 'gen_loss': 0.192}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 280] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.691, 'vae_loss': 0.207, 'gen_loss': 0.172}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.097, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.102, 'x_atac_nll': 0.11, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.112, 'dsc_loss': 0.689, 'vae_loss': 0.231, 'gen_loss': 0.197}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 290] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.692, 'vae_loss': 0.206, 'gen_loss': 0.172}, val={'g_nll': 0.422, 'g_kl': 0.009, 'g_elbo': 0.43, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.113, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.116, 'dsc_loss': 0.689, 'vae_loss': 0.239, 'gen_loss': 0.204}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 300] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.096, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.098, 'dsc_loss': 0.692, 'vae_loss': 0.208, 'gen_loss': 0.173}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.114, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.116, 'dsc_loss': 0.692, 'vae_loss': 0.238, 'gen_loss': 0.204}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 310] train={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.088, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.094, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.691, 'vae_loss': 0.206, 'gen_loss': 0.172}, val={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.105, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.107, 'dsc_loss': 0.691, 'vae_loss': 0.229, 'gen_loss': 0.195}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 320] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.205, 'gen_loss': 0.17}, val={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.108, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.11, 'dsc_loss': 0.69, 'vae_loss': 0.232, 'gen_loss': 0.198}, 0.6s elapsed
Epoch 00323: reducing learning rate of group 0 to 2.0000e-07.
Epoch 00323: reducing learning rate of group 0 to 2.0000e-07.
[INFO] LRScheduler: Learning rate reduction: step 4
[INFO] SCGLUETrainer: [Epoch 330] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.095, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.693, 'vae_loss': 0.207, 'gen_loss': 0.172}, val={'g_nll': 0.422, 'g_kl': 0.009, 'g_elbo': 0.431, 'x_rna_nll': 0.102, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.114, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.116, 'dsc_loss': 0.692, 'vae_loss': 0.24, 'gen_loss': 0.206}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 340] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.095, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.098, 'dsc_loss': 0.692, 'vae_loss': 0.208, 'gen_loss': 0.173}, val={'g_nll': 0.421, 'g_kl': 0.009, 'g_elbo': 0.43, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.115, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.118, 'dsc_loss': 0.689, 'vae_loss': 0.243, 'gen_loss': 0.209}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 350] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.693, 'vae_loss': 0.204, 'gen_loss': 0.169}, val={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.112, 'dsc_loss': 0.691, 'vae_loss': 0.233, 'gen_loss': 0.199}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 360] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.691, 'vae_loss': 0.203, 'gen_loss': 0.168}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.104, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.1, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.103, 'dsc_loss': 0.69, 'vae_loss': 0.229, 'gen_loss': 0.194}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 370] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.69, 'vae_loss': 0.203, 'gen_loss': 0.169}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.104, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.102, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.104, 'dsc_loss': 0.687, 'vae_loss': 0.231, 'gen_loss': 0.196}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 380] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.691, 'vae_loss': 0.206, 'gen_loss': 0.172}, val={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.105, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.107, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.109, 'dsc_loss': 0.69, 'vae_loss': 0.236, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 390] train={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.085, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.094, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.097, 'dsc_loss': 0.69, 'vae_loss': 0.205, 'gen_loss': 0.17}, val={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.097, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.102, 'x_atac_nll': 0.11, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.112, 'dsc_loss': 0.691, 'vae_loss': 0.231, 'gen_loss': 0.197}, 0.6s elapsed
Epoch 00393: reducing learning rate of group 0 to 2.0000e-08.
Epoch 00393: reducing learning rate of group 0 to 2.0000e-08.
[INFO] LRScheduler: Learning rate reduction: step 5
2022-06-20 16:33:52,823 ignite.handlers.early_stopping.EarlyStopping INFO: EarlyStopping: Stop training
[INFO] EarlyStopping: Restoring checkpoint "270"...
[INFO] estimate_balancing_weight: Clustering cells...
OMP: Info #277: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
[INFO] estimate_balancing_weight: Matching clusters...
[INFO] estimate_balancing_weight: Matching array shape = (6, 10)...
[INFO] estimate_balancing_weight: Estimating balancing weight...
[WARNING] configure_dataset: `configure_dataset` has already been called. Previous configuration will be overwritten!
[WARNING] configure_dataset: `configure_dataset` has already been called. Previous configuration will be overwritten!
[INFO] SCGLUEModel: Setting `graph_batch_size` = 12404
[INFO] SCGLUEModel: Setting `align_burnin` = 275
[INFO] SCGLUEModel: Setting `max_epochs` = 1648
[INFO] SCGLUEModel: Setting `patience` = 138
[INFO] SCGLUEModel: Setting `reduce_lr_patience` = 69
[INFO] SCGLUETrainer: Using training directory: "csv_example_out"
[INFO] SCGLUETrainer: [Epoch 10] train={'g_nll': 0.419, 'g_kl': 0.009, 'g_elbo': 0.428, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.692, 'vae_loss': 0.204, 'gen_loss': 0.17}, val={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.107, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.113, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.115, 'dsc_loss': 0.678, 'vae_loss': 0.244, 'gen_loss': 0.21}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 20] train={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.087, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.093, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.692, 'vae_loss': 0.206, 'gen_loss': 0.171}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.112, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.114, 'dsc_loss': 0.672, 'vae_loss': 0.237, 'gen_loss': 0.203}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 30] train={'g_nll': 0.418, 'g_kl': 0.009, 'g_elbo': 0.427, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.693, 'vae_loss': 0.205, 'gen_loss': 0.17}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.108, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.114, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.111, 'dsc_loss': 0.67, 'vae_loss': 0.242, 'gen_loss': 0.209}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 40] train={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.697, 'vae_loss': 0.204, 'gen_loss': 0.169}, val={'g_nll': 0.42, 'g_kl': 0.009, 'g_elbo': 0.429, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.112, 'dsc_loss': 0.675, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 50] train={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.694, 'vae_loss': 0.203, 'gen_loss': 0.168}, val={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.109, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.111, 'dsc_loss': 0.679, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 60] train={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.085, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.697, 'vae_loss': 0.205, 'gen_loss': 0.17}, val={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.108, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.11, 'dsc_loss': 0.68, 'vae_loss': 0.236, 'gen_loss': 0.202}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 70] train={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.086, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.69, 'vae_loss': 0.204, 'gen_loss': 0.17}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.104, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.106, 'dsc_loss': 0.696, 'vae_loss': 0.232, 'gen_loss': 0.197}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 80] train={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.085, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.693, 'vae_loss': 0.203, 'gen_loss': 0.168}, val={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.1, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.106, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.683, 'vae_loss': 0.23, 'gen_loss': 0.196}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 90] train={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.698, 'vae_loss': 0.2, 'gen_loss': 0.166}, val={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.103, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.107, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.11, 'dsc_loss': 0.682, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 100] train={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.694, 'vae_loss': 0.2, 'gen_loss': 0.165}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.101, 'x_rna_kl': 0.005, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.11, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.112, 'dsc_loss': 0.674, 'vae_loss': 0.235, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 110] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.693, 'vae_loss': 0.201, 'gen_loss': 0.166}, val={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.117, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.119, 'dsc_loss': 0.673, 'vae_loss': 0.244, 'gen_loss': 0.21}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 120] train={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.682, 'vae_loss': 0.201, 'gen_loss': 0.167}, val={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.107, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.11, 'dsc_loss': 0.673, 'vae_loss': 0.237, 'gen_loss': 0.203}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 130] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.683, 'vae_loss': 0.2, 'gen_loss': 0.166}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.099, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.114, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.117, 'dsc_loss': 0.673, 'vae_loss': 0.238, 'gen_loss': 0.205}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 140] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.685, 'vae_loss': 0.199, 'gen_loss': 0.165}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.11, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.116, 'x_atac_nll': 0.108, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.11, 'dsc_loss': 0.664, 'vae_loss': 0.243, 'gen_loss': 0.21}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 150] train={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.687, 'vae_loss': 0.2, 'gen_loss': 0.166}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.103, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.107, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.109, 'dsc_loss': 0.673, 'vae_loss': 0.235, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 160] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.685, 'vae_loss': 0.199, 'gen_loss': 0.165}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.109, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.114, 'x_atac_nll': 0.114, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.117, 'dsc_loss': 0.676, 'vae_loss': 0.248, 'gen_loss': 0.214}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 170] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.68, 'vae_loss': 0.2, 'gen_loss': 0.166}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.108, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.11, 'dsc_loss': 0.677, 'vae_loss': 0.237, 'gen_loss': 0.203}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 180] train={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.678, 'vae_loss': 0.201, 'gen_loss': 0.167}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.106, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.105, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.108, 'dsc_loss': 0.683, 'vae_loss': 0.236, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 190] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.669, 'vae_loss': 0.201, 'gen_loss': 0.168}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.1, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.113, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.115, 'dsc_loss': 0.669, 'vae_loss': 0.238, 'gen_loss': 0.205}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 200] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.088, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.671, 'vae_loss': 0.199, 'gen_loss': 0.165}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.102, 'x_atac_kl': 0.002, 'x_atac_elbo': 0.105, 'dsc_loss': 0.694, 'vae_loss': 0.229, 'gen_loss': 0.194}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 210] train={'g_nll': 0.415, 'g_kl': 0.009, 'g_elbo': 0.424, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.662, 'vae_loss': 0.201, 'gen_loss': 0.168}, val={'g_nll': 0.417, 'g_kl': 0.009, 'g_elbo': 0.426, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.11, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.113, 'dsc_loss': 0.674, 'vae_loss': 0.237, 'gen_loss': 0.204}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 220] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.661, 'vae_loss': 0.199, 'gen_loss': 0.166}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.11, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.113, 'dsc_loss': 0.695, 'vae_loss': 0.24, 'gen_loss': 0.205}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 230] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.669, 'vae_loss': 0.201, 'gen_loss': 0.167}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.101, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.112, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.115, 'dsc_loss': 0.684, 'vae_loss': 0.238, 'gen_loss': 0.204}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 240] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.657, 'vae_loss': 0.2, 'gen_loss': 0.168}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.111, 'x_atac_nll': 0.114, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.116, 'dsc_loss': 0.673, 'vae_loss': 0.244, 'gen_loss': 0.211}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 250] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.655, 'vae_loss': 0.2, 'gen_loss': 0.167}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.101, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.113, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.115, 'dsc_loss': 0.694, 'vae_loss': 0.239, 'gen_loss': 0.204}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 260] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.658, 'vae_loss': 0.201, 'gen_loss': 0.168}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.117, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.119, 'dsc_loss': 0.68, 'vae_loss': 0.244, 'gen_loss': 0.21}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 270] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.646, 'vae_loss': 0.202, 'gen_loss': 0.169}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.103, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.103, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.105, 'dsc_loss': 0.688, 'vae_loss': 0.231, 'gen_loss': 0.196}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 280] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.656, 'vae_loss': 0.202, 'gen_loss': 0.17}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.099, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.104, 'x_atac_nll': 0.112, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.114, 'dsc_loss': 0.688, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 290] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.645, 'vae_loss': 0.202, 'gen_loss': 0.17}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.103, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.115, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.117, 'dsc_loss': 0.698, 'vae_loss': 0.243, 'gen_loss': 0.208}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 300] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.641, 'vae_loss': 0.203, 'gen_loss': 0.171}, val={'g_nll': 0.409, 'g_kl': 0.009, 'g_elbo': 0.418, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.115, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.118, 'dsc_loss': 0.697, 'vae_loss': 0.242, 'gen_loss': 0.208}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 310] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.085, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.092, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.637, 'vae_loss': 0.202, 'gen_loss': 0.17}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.107, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.109, 'dsc_loss': 0.686, 'vae_loss': 0.234, 'gen_loss': 0.199}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 320] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.642, 'vae_loss': 0.2, 'gen_loss': 0.168}, val={'g_nll': 0.408, 'g_kl': 0.009, 'g_elbo': 0.417, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.11, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.112, 'dsc_loss': 0.694, 'vae_loss': 0.237, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 330] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.644, 'vae_loss': 0.202, 'gen_loss': 0.17}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.115, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.118, 'dsc_loss': 0.695, 'vae_loss': 0.245, 'gen_loss': 0.21}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 340] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.085, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.093, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.096, 'dsc_loss': 0.644, 'vae_loss': 0.203, 'gen_loss': 0.171}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.111, 'x_atac_nll': 0.117, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.12, 'dsc_loss': 0.685, 'vae_loss': 0.248, 'gen_loss': 0.213}, 0.5s elapsed
Epoch 00347: reducing learning rate of group 0 to 2.0000e-04.
Epoch 00347: reducing learning rate of group 0 to 2.0000e-04.
[INFO] LRScheduler: Learning rate reduction: step 1
[INFO] SCGLUETrainer: [Epoch 350] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.666, 'vae_loss': 0.199, 'gen_loss': 0.166}, val={'g_nll': 0.409, 'g_kl': 0.009, 'g_elbo': 0.418, 'x_rna_nll': 0.101, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.111, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.114, 'dsc_loss': 0.666, 'vae_loss': 0.238, 'gen_loss': 0.204}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 360] train={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.081, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.088, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.662, 'vae_loss': 0.198, 'gen_loss': 0.165}, val={'g_nll': 0.409, 'g_kl': 0.009, 'g_elbo': 0.418, 'x_rna_nll': 0.106, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.102, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.105, 'dsc_loss': 0.673, 'vae_loss': 0.233, 'gen_loss': 0.199}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 370] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.089, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.092, 'dsc_loss': 0.66, 'vae_loss': 0.198, 'gen_loss': 0.165}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.106, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.104, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.106, 'dsc_loss': 0.673, 'vae_loss': 0.235, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 380] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.647, 'vae_loss': 0.201, 'gen_loss': 0.168}, val={'g_nll': 0.408, 'g_kl': 0.009, 'g_elbo': 0.417, 'x_rna_nll': 0.108, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.114, 'x_atac_nll': 0.109, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.111, 'dsc_loss': 0.664, 'vae_loss': 0.242, 'gen_loss': 0.208}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 390] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.088, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.653, 'vae_loss': 0.199, 'gen_loss': 0.166}, val={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.099, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.105, 'x_atac_nll': 0.112, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.114, 'dsc_loss': 0.671, 'vae_loss': 0.236, 'gen_loss': 0.202}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 400] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.647, 'vae_loss': 0.201, 'gen_loss': 0.168}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.108, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.11, 'dsc_loss': 0.677, 'vae_loss': 0.235, 'gen_loss': 0.201}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 410] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.089, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.092, 'dsc_loss': 0.648, 'vae_loss': 0.198, 'gen_loss': 0.165}, val={'g_nll': 0.409, 'g_kl': 0.009, 'g_elbo': 0.418, 'x_rna_nll': 0.1, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.114, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.117, 'dsc_loss': 0.67, 'vae_loss': 0.24, 'gen_loss': 0.206}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 420] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.088, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.648, 'vae_loss': 0.197, 'gen_loss': 0.165}, val={'g_nll': 0.406, 'g_kl': 0.009, 'g_elbo': 0.416, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.111, 'x_atac_nll': 0.108, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.111, 'dsc_loss': 0.676, 'vae_loss': 0.238, 'gen_loss': 0.205}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 430] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.65, 'vae_loss': 0.199, 'gen_loss': 0.167}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.114, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.116, 'dsc_loss': 0.672, 'vae_loss': 0.243, 'gen_loss': 0.209}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 440] train={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.644, 'vae_loss': 0.199, 'gen_loss': 0.167}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.111, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.113, 'dsc_loss': 0.668, 'vae_loss': 0.238, 'gen_loss': 0.205}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 450] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.652, 'vae_loss': 0.2, 'gen_loss': 0.168}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.11, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.116, 'x_atac_nll': 0.11, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.113, 'dsc_loss': 0.665, 'vae_loss': 0.246, 'gen_loss': 0.212}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 460] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.647, 'vae_loss': 0.199, 'gen_loss': 0.167}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.109, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.111, 'dsc_loss': 0.669, 'vae_loss': 0.238, 'gen_loss': 0.204}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 470] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.653, 'vae_loss': 0.2, 'gen_loss': 0.167}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.1, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.113, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.116, 'dsc_loss': 0.662, 'vae_loss': 0.238, 'gen_loss': 0.205}, 0.5s elapsed
[INFO] SCGLUETrainer: [Epoch 480] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.088, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.654, 'vae_loss': 0.199, 'gen_loss': 0.166}, val={'g_nll': 0.408, 'g_kl': 0.009, 'g_elbo': 0.418, 'x_rna_nll': 0.108, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.114, 'x_atac_nll': 0.111, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.114, 'dsc_loss': 0.671, 'vae_loss': 0.245, 'gen_loss': 0.212}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 490] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.652, 'vae_loss': 0.2, 'gen_loss': 0.167}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.101, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.107, 'x_atac_nll': 0.107, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.11, 'dsc_loss': 0.659, 'vae_loss': 0.233, 'gen_loss': 0.2}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 500] train={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.654, 'vae_loss': 0.199, 'gen_loss': 0.167}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.114, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.116, 'dsc_loss': 0.68, 'vae_loss': 0.243, 'gen_loss': 0.209}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 510] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.656, 'vae_loss': 0.199, 'gen_loss': 0.166}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.111, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.113, 'dsc_loss': 0.674, 'vae_loss': 0.24, 'gen_loss': 0.207}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 520] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.651, 'vae_loss': 0.201, 'gen_loss': 0.168}, val={'g_nll': 0.406, 'g_kl': 0.009, 'g_elbo': 0.415, 'x_rna_nll': 0.1, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.109, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.112, 'dsc_loss': 0.681, 'vae_loss': 0.234, 'gen_loss': 0.2}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 530] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.653, 'vae_loss': 0.201, 'gen_loss': 0.169}, val={'g_nll': 0.416, 'g_kl': 0.009, 'g_elbo': 0.425, 'x_rna_nll': 0.106, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.112, 'x_atac_nll': 0.105, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.108, 'dsc_loss': 0.668, 'vae_loss': 0.237, 'gen_loss': 0.204}, 0.6s elapsed
Epoch 00539: reducing learning rate of group 0 to 2.0000e-05.
Epoch 00539: reducing learning rate of group 0 to 2.0000e-05.
[INFO] LRScheduler: Learning rate reduction: step 2
[INFO] SCGLUETrainer: [Epoch 540] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.088, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.655, 'vae_loss': 0.2, 'gen_loss': 0.167}, val={'g_nll': 0.408, 'g_kl': 0.009, 'g_elbo': 0.417, 'x_rna_nll': 0.104, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.11, 'x_atac_nll': 0.113, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.116, 'dsc_loss': 0.67, 'vae_loss': 0.242, 'gen_loss': 0.209}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 550] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.659, 'vae_loss': 0.2, 'gen_loss': 0.167}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.1, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.106, 'x_atac_nll': 0.109, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.111, 'dsc_loss': 0.669, 'vae_loss': 0.234, 'gen_loss': 0.2}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 560] train={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.655, 'vae_loss': 0.199, 'gen_loss': 0.166}, val={'g_nll': 0.414, 'g_kl': 0.009, 'g_elbo': 0.423, 'x_rna_nll': 0.103, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.109, 'x_atac_nll': 0.103, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.106, 'dsc_loss': 0.669, 'vae_loss': 0.231, 'gen_loss': 0.198}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 570] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.091, 'x_atac_nll': 0.092, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.095, 'dsc_loss': 0.653, 'vae_loss': 0.202, 'gen_loss': 0.17}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.102, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.108, 'x_atac_nll': 0.113, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.115, 'dsc_loss': 0.662, 'vae_loss': 0.24, 'gen_loss': 0.207}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 580] train={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.083, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.66, 'vae_loss': 0.2, 'gen_loss': 0.167}, val={'g_nll': 0.412, 'g_kl': 0.009, 'g_elbo': 0.421, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.111, 'x_atac_nll': 0.118, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.12, 'dsc_loss': 0.675, 'vae_loss': 0.248, 'gen_loss': 0.214}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 590] train={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.082, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.089, 'x_atac_nll': 0.09, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.093, 'dsc_loss': 0.659, 'vae_loss': 0.198, 'gen_loss': 0.165}, val={'g_nll': 0.413, 'g_kl': 0.009, 'g_elbo': 0.422, 'x_rna_nll': 0.105, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.111, 'x_atac_nll': 0.112, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.115, 'dsc_loss': 0.666, 'vae_loss': 0.243, 'gen_loss': 0.21}, 0.6s elapsed
[INFO] SCGLUETrainer: [Epoch 600] train={'g_nll': 0.411, 'g_kl': 0.009, 'g_elbo': 0.42, 'x_rna_nll': 0.084, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.09, 'x_atac_nll': 0.091, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.094, 'dsc_loss': 0.653, 'vae_loss': 0.2, 'gen_loss': 0.168}, val={'g_nll': 0.41, 'g_kl': 0.009, 'g_elbo': 0.419, 'x_rna_nll': 0.109, 'x_rna_kl': 0.006, 'x_rna_elbo': 0.115, 'x_atac_nll': 0.111, 'x_atac_kl': 0.003, 'x_atac_elbo': 0.114, 'dsc_loss': 0.661, 'vae_loss': 0.246, 'gen_loss': 0.213}, 0.6s elapsed
2022-06-20 16:40:56,130 ignite.handlers.early_stopping.EarlyStopping INFO: EarlyStopping: Stop training
[INFO] EarlyStopping: Restoring checkpoint "523"...
/fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Codes/4_Infer_CRE_gene_links.py:76: FutureWarning: biadjacency_matrix will return a scipy.sparse array instead of a matrix in NetworkX 3.0
  dist = biadjacency_matrix(dist_graph, genes.index, peaks.index, weight = "dist", dtype = np.float32)
  0%|          | 0/35885 [00:00<?, ?it/s] 25%|██▌       | 9112/35885 [00:00<00:00, 91110.53it/s] 51%|█████▏    | 18405/35885 [00:00<00:00, 92173.96it/s] 77%|███████▋  | 27676/35885 [00:00<00:00, 92415.73it/s]100%|██████████| 35885/35885 [00:00<00:00, 91989.57it/s]
/fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Codes/4_Infer_CRE_gene_links.py:99: FutureWarning: biadjacency_matrix will return a scipy.sparse array instead of a matrix in NetworkX 3.0
  glue = biadjacency_matrix(glue_graph, genes.index, peaks.index, weight="score", dtype=np.float32)
/fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Codes/4_Infer_CRE_gene_links.py:100: FutureWarning: biadjacency_matrix will return a scipy.sparse array instead of a matrix in NetworkX 3.0
  qval = biadjacency_matrix(glue_graph, genes.index, peaks.index, weight="qval", dtype=np.float32)
/fs/ess/PCON0022/liyang/STREAM/benchmarking/GLUE/Codes/4_Infer_CRE_gene_links.py:104: FutureWarning: biadjacency_matrix will return a scipy.sparse array instead of a matrix in NetworkX 3.0
  window = biadjacency_matrix(
